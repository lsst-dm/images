
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Document:      DM  Doc Tree
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass{article}

\usepackage{times,layouts}
\usepackage{tikz,hyperref,amsmath}
\usetikzlibrary{positioning,arrows,shapes,decorations.shapes,shapes.arrows}
\usetikzlibrary{backgrounds,calc}

\usepackage[paperwidth=37cm,paperheight=22cm,
left=-2mm,top=3mm,bottom=0mm,right=0mm,
noheadfoot,marginparwidth=0pt,includemp=false
]{geometry}


\newcommand\showpage{%
\setlayoutscale{0.5}\setlabelfont{\tiny}\printheadingsfalse\printparametersfalse
\currentpage\pagedesign}

\hypersetup{pdftitle={DM doc tree }, pdfsubject={Documentation tree for LSST DM }, pdfauthor={ William O'Mullane}}

\input{styles}


\begin{document}

\begin{tikzpicture}[node distance=0mm]


    \node (oss) [docbox ] { Observatory System Spec LSE-30 (OSS) };
	\node (daicd) [docboxicd, left=11cm of oss] { DM Data Acq ICD LSE-68 };
	\node (camicd) [docboxicd, above=0.2cm of daicd] { DM Camera ICD LSE-69 };
	\node (csicd) [docboxicd, above=0.2cm of camicd] { DM Telescope Control Sys ICD LSE-75 };
	\node (sumicd) [docboxicd, above=0.2cm of csicd] { DM Summit Infra ICD LSE-76 };
	\node (baseicd) [docboxicd, above=0.2cm of sumicd] { DM Base Infra ICD LSE-77 };
	\node (epoicd) [docboxicd, above=0.2cm of baseicd] { DM EPO ICD LSE-131 };
	\node (auxicd) [docboxicd, above=0.2cm of epoicd] { DM Telescope Aux  ICD LSE-140 };
    \node (lsr) [docbox, right = 1cm of oss] { LSST  System Requirements LSE-29 (LSR)};
	\node (srd) [docbox, right = 1cm of lsr] { LSST  Science Requirements LPM-17 (SRD)};
%  LEGEND
	\node(legend) [below=1cm of oss] {};
	\node(legendr) [right=1cm of legend] {};
	\draw[dline] (legend) to (legendr);
	\node(dtext) [right= 2mm of legendr] {Specification and Design};
	\node(legend2) [below=2mm of legend] {};
	\node(legend2r) [right=1cm of legend2] {};
	\draw[pline] (legend2) to (legend2r);
	\node(ptext) [right= 2mm of legend2r] {Planning};
	\node(legend3) [below=2mm of legend2] {};
	\node(legend3r) [right=1cm of legend3] {};
	\draw[tline] (legend3) to (legend3r);
	\node(ttext) [right= 2mm of legend3r] {Test and Validation};
	\node (nf) [docboxm, left=5mm of legend2] { Multiple docs issued over time };
	\node (icd) [docboxicd, left=5mm of nf] { Interface Control Document (ICD) };
	%\node (upd) [docboxu, left=5mm of icd] { Needs Update};
	%Keeping in case we ever have needs update again
%%%
	\node (srp) [above=15mm of oss.north] {};
	\node (dmsr) [docbox, left=3mm of srp] { DM System Requirements  LSE-61 (DMSR)};
	\node (dmsrp) [left=20 mm of dmsr] {};
	\node (dqap) [docbox, below=7mm of dmsrp] { LSST Data Quality Assurance Plan LSE-63 (DQAP)};
	\node (dpdd) [docbox, right=2mm of srp] { LSST Data Products  LSE-163 (DPDD)};
	\node (svtp) [docbox, left=44mm of dmsr.west] { DM  Validation \& Test Plan LDM-503 (SVTP)};
    \node (pmp) [docbox, right=60mm of dpdd.east] { DM PMP LDM-294};
    \node (pmpp) [above=20mm of pmp] {};
    \node (crd) [docbox, text width=38mm,  right=30mm of pmp.east] {Release Management LDM-672};
    \node (vcd) [docbox, above=5mm of crd.north] { DM Verification Control (VCD) LDM-692};

    %\node (crdots) [right=1mm of compx.east] {\huge \ldots \ldots};
%LDM-154, DB LDM-155, Middleware LDM-156%%
%%%%%% REQUIREMENTS %%%%%
    \node (scipr) [docbox, above=10mm of dmsr] { Science Platform Requirements LDM-554};
    \node (mwr) [docbox, right=5mm of scipr] { Middleware Requirements LDM-556};
    \node (compd)  [docbox, above=12mm of mwr] { System Architecture  LDM-148};
    \node (compdp) [above=5.5mm of compd] {};
    \node (compdp1) [above=18mm of compd] {};
    \node (dbr) [docbox, left=5mm of scipr] { Database Requirements LDM-555};
    \node (dbbr) [docbox, right=5mm of mwr] { DataBackbone  Requirements LDM-635};
    \node (bpsr) [docbox, right=5mm of dbbr] { Batch System  Requirements LDM-636};

    \node (scipc) [docbox, left= of compdp1] { Science Platform Design LDM-542};
   % \node (suitc) [docboxu, above=5mm of scipc] { SUIT Design LDM-131};
    \node (mwc)  [docbox, left=5mm of scipc] { Middleware Design LDM-152};
    \node (dbc)  [docbox, left=5mm of mwc] { Database  Design LDM-135};
    \node (infrac)  [docbox, right=5mm of scipc] { Services \& Infrastructure LDM-129};
    \node (plc)  [docbox, right=5mm of infrac.east] {Pipeline Design LDM-151};
    \node (netc) [docbox, right=5mm of plc.east] { Network Design LSE-78};
    \node (dmtn199) [docbox, right=5mm of netc.east] { Security Standards DMTN-199};
    \node (userd)  [docbox, right=85mm of compd] { User Documentation };

    %%%%%%%%%%% TEST SPECS %%%%%%%%%%%%%%
    \node (scipt) [docbox, above=10mm of scipc] {Science Platform  Test Spec LDM-540 };
    \node (actp) [docbox, left=30mm of scipt ] { Acceptance Test Spec LDM-639};




  %%%%%%%%%% component tests %%%%%%%%%%%%%%%%%%%

    %\node (l2kpm) [docbox, above=5mm of l2t] { L2 KPMs  LDM-502};
    %\node (qservt) [docbox, above=5mm of dbbt] { Qserv test spec LDM-552 } ;

  %%%%%%%%%% test reports %%%%%%%%%%%%%%%%%%%
    \node (acptr) [docboxm, above=6mm of actp] { Acceptance Test Reports };
    \node (acpt1) [docbox, above = 6mm of acptr ] { e.g. Pipeline  Fall test DMTR-199 };

    %\node (l2tr) [docbox, above=25mm of l2t] { L2 Test Reports };

    \node (sciptr) [docboxm, above=6mm of scipt] { Science Platform Test Reports };
    \node (sciptr1) [docbox, above=6mm of sciptr] { e.g. Portal Inegration DMTR-211 };
    \node (mtp) [docboxm, left=71mm of sciptr ] { Milestone test reports};
    \node (mtp1) [docbox, above=6mm of mtp ] { e.g. 503-11b Plan/Report DMTR-192 };

   \draw[dline] (dmsr.north) --  ++(0,0.5) -| (bpsr.south);
   \draw[dline] (dmsr.north) -- ++(0,0.5) -| (dbr.south);
   \node (sciprp) [below=0.5 of scipr.south] {};
   \draw[dline] (sciprp) to  (scipr.south);
   \node (mwrp) [below=0.5 of mwr.south] {};
   \draw[dline] (mwrp) to (mwr.south);
   \node (dbbrp) [below=0.5 of dbbr.south] {};
   \draw[dline] (dbbrp) to (dbbr.south);

   %%% DESSIGN LINES %%%%
   \draw[dline] (dbr.north) --  ++(0,0.5) -| (compd.south);
   \node (compdb) [above=5mm of mwr] {};
   \draw[dlines] (mwr.north) -- ++(0,0.5)  ;
   \draw[dlines] (scipr.north)-- ++(0,0.5) ;
   \draw[dlines] (dbbr.north) -- ++(0,0.5) ;
   \draw[dlines] (bpsr.north) -- ++(0,0.5) -|  (compdb.south);

   \draw[dline] (dpdd.west) to (dmsr.east);
   \draw[dline]   (oss.west) ++(-0.2,0)   |- (dqap.east);
   \draw[dline] (oss.north) -- ++(0.0,0.5) -| (dmsr.south);
   %\draw[dline] (dpdd.south)to (oss.north);
   %\draw[dlines] (oss.north) -- ++(0,0.5); % (dmsr.south);
   \draw[dline] (lsr.west) to (oss.east)  ;
   \draw[dline] (srd.west) to (lsr.east) ;
   \draw[dline] (srd.north) ++(-1.1,0)  |- (dpdd.east) ;


   \node (scipcp) [below=5mm of scipc] {};
   \draw[dline] (scipcp.north) to (scipc.south);
   \draw[dline] (scipcp.north) -| (netc.south);

   \node (plcp) [below=5mm of plc] {};
   \draw[dline] (plcp.north) to (plc.south);

   \node (mwcp) [below=5mm of mwc] {};
   \draw[dline] (mwcp.north) to  (mwc.south);

   \node (infracp) [below=5mm of infrac] {};
   \draw[dline] (infracp.north) -| (infrac.south);

   \node (dbcp) [below=5mm of dbc] {};
   \draw[dline] (dbcp.north) to (dbc.south);

   \draw[dlines] (plcp.north) -- (dbcp.north);
   \draw[dlines] (scipcp.north) -- (plcp.north);
   \draw[dlines] (compd.north) -- (compdp.north);


   %\node (l2tp) [left=3mm of l2t] {};
   %\node (l2tpb) [below=10mm of l2tp.east] {};
   %\draw[dline] (l2tpb.west) |-  (l2t.west);


%long line for test specs
   \draw[dline] (svtp.north) -- ++(0.0,5.0) -| (mtp.south);
   %\draw[dline] (svtp.north) --  (mtp.south);
   \draw[dline] (mtp.north) --  (mtp1.south);


   \draw[tlines] (mtp1.north) -- ++(0,0.6);
   \draw[tlines] (acpt1.north) -- ++(0,0.6);
   \draw[tlines] (sciptr1.north) -- ++(0,0.6);

   \node(vcdstartline) [above=4mm of mtp1]{};
   \draw[tline] (vcdstartline.north)   -| (vcd.north);
   %\draw[tlines] (ncsaenctr.north) -- (ncsaenctrp.north);
   %\draw[tline] (acpt1.north) -- ++(0,0.6)  -| (actp.north);

   \draw[tline] (svtp.east) to (dmsr.west);
  % \draw[tline] (l2t.south) to (plc.north);

   \draw[tline] (scipt.south) to (scipc.north);
   \draw[tline] (actp.south) --  ++(0,-0.5) -| (dbc.north);
   \draw[tline] (actp.south) --  ++(0,-0.5) -| (netc.north);
   \draw[tline] (actp.south) --  ++(0,-0.5) -| (dmtn199.north);

   \node(mwcap) [above=0.5 of mwc]{};
   \draw[tline]  (mwcap) -- (mwc.north) ;

   \node(infracap) [above=0.5 of infrac]{};
   \draw[tline] (infracap) -- (infrac.north);

   \node(plcap) [above=0.5 of plc]{};
   \draw[tline] (plcap) -- (plc.north);
%reports
   \draw[dline] (sciptr.north) to (sciptr1.south);
   \draw[dline] (scipt.north) to (sciptr.south);
   \draw[dline] (acptr.north) to (acpt1.south);
   \draw[dline] (actp.north) to (acptr.south);

   \draw[dline] ++(-11.78,+7) --  (compd.west);



   \draw[pline] (pmp.north) |-  (compd.east);
   \draw[pline] (pmp.north) |-  (userd.west);
   \draw[pline] (pmp.east) -- (vcd.west);
   \draw[pline] (pmp.east) -|  (crd.west);

 %icds
   \node (daicdp) [right=0.8cm of daicd.east] {};
   \draw[dline] (daicdp.west) -- (daicd.east);

   \node (camicdp) [right=0.8cm of camicd.east] {};
   \draw[dline] (camicdp.west) -- (camicd.east);
   \node (csicdp) [right=0.8cm of csicd.east] {};
   \draw[dline] (csicdp.west) -- (csicd.east);
   \node (sumicdp) [right=0.8cm of sumicd.east] {};
   \draw[dline] (sumicdp.west) -- (sumicd.east);

   \node (baseicdp) [right=0.8cm of baseicd.east] {};
   \draw[dline] (baseicdp.west) -- (baseicd.east);

   \node (epoicdp) [right=0.8cm of epoicd.east] {};
   \draw[dline] (epoicdp.west) -- (epoicd.east);


   \node (auxicdp) [right=0.8cm of auxicd.east] {};
   \draw[dlines] (oss.west) -| (auxicdp.west);
   \draw[dline] (auxicdp.west) -- (auxicd.east);

\end{tikzpicture}
\end{document}
