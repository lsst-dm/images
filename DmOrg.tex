
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Document:      DM  organisation chart reporting lines
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass{article}

\usepackage{times,layouts}
\usepackage{tikz,hyperref,amsmath}
\usetikzlibrary{positioning,arrows,shapes,decorations.shapes,shapes.arrows}
\usetikzlibrary{backgrounds,calc}

\usepackage[paperwidth=30cm,paperheight=20.0cm,
left=-2mm,top=3mm,bottom=0mm,right=0mm,
noheadfoot,marginparwidth=0pt,includemp=false ]{geometry}


\newcommand\showpage{%
\setlayoutscale{0.5}\setlabelfont{\tiny}\printheadingsfalse\printparametersfalse
\currentpage\pagedesign}

\hypersetup{pdftitle={DM organisation }, pdfsubject={Diagram illustrating the
 reporting lines in LSST DM Group}, pdfauthor={ William O'Mullane}}

\input{styles}


% Team with a Manager & a Product Owner
\newcommand\dmmnode[6][]{
            \node (#2) [mbox, text width=100mm, rectangle split, rectangle split parts=2, #1]
                {
                \strut #3
                \nodepart{second} \vspace{12mm}
                };
             \node({#2}v) [below=12mm of {#2}.north, text width=0mm] {};

             \node({#2}t) [mbox,minimum height=9mm, left=0mm of {#2}v, text width=45mm] {\parbox[height=6mm]{0pt}{}{\small \bf Manager }\\\strut#4};
             \node({#2}s) [#6,minimum height=9mm, right=2mm of {#2}t, text width=45mm] {{\small \bf Product Owner}\\\strut#5};
        }

% Team with a T/CAM and a Product Owner
\newcommand\dmnode[6][]{
            \node (#2) [mbox, text width=36mm, rectangle split, rectangle split parts=2, #1]
                {
                \strut #3
                \nodepart{second} \vspace{39mm}
                };
             \node({#2}t) [mbox,minimum height=9mm, below=8mm of {#2}.north, text width=32mm] {\parbox[height=6mm]{0pt}{}{\small \bf T/CAM}\\\strut#4};
             \node({#2}s) [#6,minimum height=9mm, below=2pt of {#2}t, text width=32mm] {{\small \bf Product Owner}\\\strut#5};
        }


\begin{document}

\begin{tikzpicture}[node distance=0mm]


    \node (dm) [arcbox, align=left, text width=24cm,  minimum height=10mm, rectangle split, rectangle split parts=2]
    { \hspace{0.1cm} \textbf{Data Management Leadership Team (DMLT)}
	   \nodepart{second} \vspace{170mm}
	};

    \node (dmpm) [divbox, above=-2.5cm of dm.north] {\textbf{DM Project Manager} William O'Mullane};
    \node (dmdpm) [divbox, left=1.5cm of dmpm] {\textbf{DM Deputy Manager} Frossie Economou};
    \node (pm) [divbox, above=.5cm of dm] {\textbf{ Project Manager} Victor Krabbendam};
    \node (dmps) [psbox, right=1.3cm of dmpm, minimum height=12mm, text width=39mm] {\textbf{ DM Scientist}\\ Leanne Guy };
    \node (ddmps) [psbox, right=0.4cm of dmps, minimum height=12mm, text width=41mm] {\textbf{ DM Deputy Scientist}\\ Colin Slater };
  %  \node (dmadv) [psbox, below=1.0cm of dmps ] {\textbf{Senior Advisor\\Pipeline Scientist}\\ Robert Lupton};
    \node (ps) [psbox, right=1.5cm of pm, minimum height=12mm] {\textbf{  Project Scientist}\\ Steve Ritz};

    \node (udmpm) [below=61mm of dmpm, text width=0mm]{};
    \node (udmpm1) [below=35mm of dmpm, text width=0mm]{};
    \node (udmpm2) [below=125mm of dmpm, text width=0mm]{};

    \node (ccbVpos) [below=42mm of dmpm, text width=0mm]{};
    \node (rmVpos) [below=41mm of ccbVpos, text width=0mm]{};
    \node (sciplatVpos) [below=39mm of ccbVpos, text width=0mm]{};
    \node (mwareVpos) [below=60mm of dmpm, text width=0mm]{};

% SYSENG
            \node (sysengg) [mbox, text width=55mm, rectangle split, rectangle split parts=2, left=3.1cm of ccbVpos.north]
                {
                 Core DMCCB
                \nodepart{second} \vspace{50mm}
                };
    \node (chair) [mbox, below=6mm of sysengg.north, text width=42mm] {\textbf{ System Engineer (Chair) }\\ Tim Jenness };
    \node (dmsci) [psbox, below=1mm of chair, text width=42mm] {\textbf{DM Scientist}\\ Leanne Guy};
    \node (ops) [mbox, below=1mm of dmsci, text width=42mm] {\textbf{ Operations  Architect}\\ Steven Pietrowicz };
    \node (softarc) [mbox, below=1mm of ops, text width=42mm] {\textbf{ Software Architect}\\ Kian Tat Lim };
    \node (man) [mbox, below=1mm of softarc, text width=42mm] {\textbf{ DM Manager }\\ William O'Mullane };
%%%% end SYSENG

    \node (pconp) [below=25mm of dmps] {};
    \node (pcon) [mbox, right=70mm of pconp , text width=45mm] {\textbf{Project Control/Scheduler }\\ Kevin Long};
    \node (admin) [mbox, below=8mm of pcon, text width=45mm] {\textbf{DM Admin}\\ Glenaver Charles-Emerson\\ Erin Carlson};


    %\node (al) [below=69mm of dmpm, text width=0mm]{};
    \dmmnode[right=10mm of sciplatVpos.north]{sciplat}{Science Platform}{Frossie Economou}{Gregory Dubois-Felsmann}{psbox} ;
    \dmmnode[right=10mm of mwareVpos.north]{mware}{Middleware}{Tim Jenness}{Jim Bosch}{psbox} ;
    \dmnode[left=20.9mm of udmpm2.north]{das}{Data Access Services}{Fritz Mueller}{Colin Slater} {psbox};

    \node (drp) [mbox, text width=36mm, rectangle split, rectangle split parts=2, base left=2mm of das]
         {Science Pipelines \strut \nodepart{second} \vspace{39mm}};

         \node(drpt) [mbox,minimum height=9mm, below=8mm of {drp}.north, text width=32mm] {\parbox[height=12mm]{0pt}{}{\small \bf T/CAM}\\\strut  Yusra AlSayyad \\ {\bf Deputy}\\ Ian Sullivan };
         \node(drps) [psbox,minimum height=9mm, below=2pt of drpt, text width=32mm] {{\small \bf DRP Owner}\\\strut Jim Bosch};
         \node(alerts) [psbox,minimum height=9mm, below=2pt of drps, text width=32mm] {{\small \bf Alerts Owner}\\\strut Eric Bellm};

	 \dmnode[base right=2mm of das]{square}{SQuaRE} {\strut Frossie Economou}{ Simon Krughoff }{psbox} ;


	 \dmnode[base right=2mm of square]{infra}{Data Facility }{Steven Pietrowicz}{Leanne Guy}{psbox} ;
	 \dmnode[base right=2mm of infra]{lhn}{IT, LHN, Base Site}{Cristian Silva}{Steven Pietrowicz}{pobox} ;

 %% GROUPS ..

    \node (dmsg) [psbox, above=0.8cm of pcon, minimum height=12mm] {\textbf{DM Subsystem Science Team}};

   \draw[line] (dmps.south) |-  (dmsg.west);
   \draw[line] (dmps.north) --  (ps.south);
   \draw[line] (ddmps.west) --  (dmps.east);

   \draw[line] (dmpm.north) -- ++(0,0.8) -| (pm.south);
   \draw[line] (dmdpm.east) --  (dmpm.west);
 %  \draw[sline] (dmadv.west) -|  (dmpm.south);
  % \draw[line] (dmadv.north) --  (dmps.south);

%dm lines second number is the proportional turning point of the line
  % \draw[line] (alerts.north) -- ++(0,0.3) -| (dmpm.south);
   \draw[line] (drp.north) -- ++(0,0.3) -| (dmpm.south);
   \draw[line] (das.north) -- ++(0,0.3) -| (dmpm.south);
   \draw[line] (sciplat.west) -- (sciplatVpos.north);
   \draw[line] (mware.west) -- (mwareVpos.north);
   \draw[line] (square.north) -- ++(0,0.3) -| (dmpm.south);
   \draw[line] (infra.north) -- ++(0,0.3) -| (dmpm.south);
   \draw[line] (lhn.north) -- ++(0,0.3) -| (dmpm.south);

   \draw[line] (sysengg.east) to (ccbVpos.north);
   \draw[line] (pcon.west) -| (udmpm1.north);
   \draw[line] (admin.west) -| (udmpm.north);
%science
   \draw[sline] (ps.west) to (pm.east);
   \draw[sline] (dmps.west) to (dmpm.east);


\end{tikzpicture}
\end{document}
